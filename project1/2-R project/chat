
---
title: "Attrition Analysis"
format: html
editor: visual
---

```{r}
# Load packages
library(tidyverse)
library(readr)
library(ggplot2)
library(corrplot)
library(caret)
```

## Load Data

```{r}
# Load the dataset
data <- read_csv("original.csv")
```

## Inspect Structure

```{r}
# Structure and summary
glimpse(data)
summary(data)
colSums(is.na(data))
```

## Convert Character Columns to Factor

```{r}
# Convert character columns to factor
data <- data %>%
  mutate(across(where(is.character), as.factor))

str(data)
```

## Summary Statistics

```{r}
# Mean and standard deviation for numeric variables
data %>%
  summarise(across(where(is.numeric), list(mean = mean, sd = sd), .names = "{.col}_{.fn}"))
```

## Attrition Rates by Category

```{r}
data %>%
  group_by(JobRole, Attrition) %>%
  summarise(Count = n(), .groups = "drop") %>%
  mutate(Percent = round(Count / sum(Count) * 100, 1))
```

## Correlation Matrix

```{r}
# Correlation matrix for numeric variables
num_data <- data %>% select(where(is.numeric))
cor_matrix <- cor(num_data)

round(cor_matrix, 2)
```

## Correlation Heatmap

```{r}
corrplot(cor_matrix, method = "color", type = "lower", tl.cex = 0.6)
```

## Visualizations

### Age Distribution

```{r}
ggplot(data, aes(x = Age)) +
  geom_histogram(binwidth = 5, fill = "skyblue", color = "black") +
  theme_minimal()
```

### Monthly Income vs. Attrition

```{r}
ggplot(data, aes(x = Attrition, y = MonthlyIncome)) +
  geom_boxplot(fill = "salmon") +
  theme_minimal()
```

### Job Role vs. Attrition

```{r}
ggplot(data, aes(x = JobRole, fill = Attrition)) +
  geom_bar(position = "fill") +
  coord_flip() +
  labs(y = "Proportion") +
  theme_minimal()
```

## Logistic Regression: Factors Affecting Attrition

```{r}
# Recode Attrition to binary
data$Attrition <- ifelse(data$Attrition == "Yes", 1, 0)

# Fit logistic regression model
model <- glm(Attrition ~ Age + JobRole + MonthlyIncome + OverTime + YearsAtCompany, 
             data = data, family = "binomial")

summary(model)
```
